<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom"><id>https://github.com/enderTree/gitblog</id><title>RSS feed of enderTree's gitblog</title><updated>2025-06-24T07:49:08.128578+00:00</updated><link href="https://github.com/enderTree/gitblog"/><link href="https://raw.githubusercontent.com/enderTree/gitblog/master/feed.xml" rel="self"/><generator uri="https://lkiesow.github.io/python-feedgen" version="1.0.0">python-feedgen</generator><entry><id>https://github.com/enderTree/gitblog/issues/1</id><title>报单系统23年数据备份</title><updated>2025-06-24T07:49:08.484695+00:00</updated><content type="html"><![CDATA[<h3>1. 数据记录</h3>
<p>共10316条</p>
<pre><code>SELECT 
    MAX(create_time) as max_create_time,
    MIN(create_time) as min_create_time,
    order_status_desc,
    COUNT(1)
FROM 
    order_order
WHERE 
    create_time &lt; &#x27;2024-01-01 00:00:00&#x27;
    -- AND is_del=0
    -- and status=1
GROUP BY 
    order_status_desc
;
</code></pre>
<p><img src="https://github.com/user-attachments/assets/32ce000d-1bb1-443a-ab36-c9404b6fc474" alt="Image" /></p>
<h3>2. 数据备份</h3>
<pre><code>CREATE TABLE `order_order_2023_20250623` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `activity_id` int(11) NOT NULL,
  `order_no` varchar(255) NOT NULL,
  `deposit_amt` bigint(20) DEFAULT NULL,
  `amt` bigint(20) DEFAULT NULL,
  `deposit_img` varchar(255) DEFAULT NULL,
  `order_img` int(11) DEFAULT NULL,
  `compute_img` int(11) DEFAULT NULL,
  `discuss_img` int(11) DEFAULT NULL,
  `deposit_time` datetime(6) DEFAULT NULL,
  `order_time` datetime(6) DEFAULT NULL,
  `compute_time` datetime(6) DEFAULT NULL,
  `discuss_time` datetime(6) DEFAULT NULL,
  `is_comfirm_7` tinyint(1) NOT NULL,
  `comfirm_time` datetime(6) DEFAULT NULL,
  `rebate_amt` bigint(20) DEFAULT NULL,
  `order_status` varchar(50) NOT NULL,
  `order_status_desc` varchar(255) NOT NULL,
  `status` tinyint(1) NOT NULL,
  `is_del` tinyint(1) NOT NULL,
  `create_time` datetime(6) NOT NULL,
  `create_by` varchar(50) DEFAULT NULL,
  `update_time` datetime(6) NOT NULL,
  `update_by` varchar(50) DEFAULT NULL,
  `source_system` varchar(50) NOT NULL,
  `reject_remark` varchar(255) NOT NULL,
  `order_remark` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_ac` (`source_system`,`activity_id`),
  KEY `idx_activity_1` (`source_system`,`activity_id`),
  KEY `idx_order_no` (`order_no`)
) ENGINE=InnoDB AUTO_INCREMENT=14263 DEFAULT CHARSET=utf8 comment=&#x27;订单表20250623号备份2023年数据&#x27;;

INSERT INTO order_order_2023_20250623 
SELECT 
    * 
FROM 
    order_order
WHERE 
    create_time &lt; &#x27;2024-01-01 00:00:00&#x27;
;

DELETE FROM order_order
WHERE 
    create_time &lt; &#x27;2024-01-01 00:00:00&#x27;
;
</code></pre>
]]></content><link href="https://github.com/enderTree/gitblog/issues/1"/><category term="baodan"/><published>2025-06-24T07:35:09+00:00</published></entry></feed>